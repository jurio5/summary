
- 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 자동으로 삭제
- `orphanRemoval = true`
- 쉽게 말하면, 영속성 전이(`CASCADE`)의 경우는 부모와 자식간의 생명주기를 같게 유지를 한다고 하면, `orphanRemoval`같은 경우는 `parent.getChildList().remove(child)`를 통해 컬렉션 내부에서 지워버리면, JPA는 실제로 DB에 `DELETE`쿼리를 날려주는 역할을 하며, 부모 엔티티의 `PK`는 그대로 생존하고 있는 상황이 된다.
- 반대로 부모 객체가 사라지면 영속성 전이의 `REMOVE`처럼 함께 제거된다.

### 고아 객체 주의 사항

- 참조가 제거된 엔티티는 다른 곳에서 참조하지 않는 고아 객체로 보고 삭제하는 기능
- 참조하는 곳이 하나일 때 사용해야 함
- 특정 엔티티가 개인 소유할 때 사용
- `parent`가 `child`를 소유하고 있을 때 처럼
- `@OneToOne`,`@OneToMany` 연관관계 일 떄 사용 가능
- 개념적으로 부모를 제거하면 자식은 고아가 된다. 따라서 고아 객체 제거 기능을 활성화 하면, 부모를 제거할 때 자식도 함께 제거된다. (`CASCADE` 영속성 전이 옵션의 `REMOVE` 처럼 동작)

### 영속성 전이 + 고아 객체, 생명 주기

- `CascadeType.ALL` + `orphanRemoval = true`
- 보통 스스로 생명주기를 관리하는 엔티티는 `em.persist()`로 영속화, `em.remove()`로 제거
- 그런데 두 옵션을 모두 활성화 하면 부모 엔티티를 통해서 자식의 생명주기를 관리할 수 있음
- `em.persist(parent)` -> 부모만 영속화 해도 자식도 같이 영속화
- `em.remove(parent)` -> 부모를 삭제해도 자식도 같이 삭제
- `parent.getChildList().remove(0)` -> 부모에서 자식 컬렉션을 참조해서 자식을 삭제 (생명주기를 부모가 관리)
- 도메인 주도 설계(`DDD`)의 `Aggregate Root` 개념을 구현할 때 유용