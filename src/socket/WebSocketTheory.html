### 웹 소켓의 동작 방식

- HTML5 표준 기술로, HTTP 환경에서 클라이언트와 서버 사이에 하나의 TCP 연결을 통해 실시간으로 전이중 통신을 가능하게 하는 프로토콜

- 웹 소켓 기술이 없었을 땐 `Polling`이나 `Long polling`등의 방식으로 실시간에 준하게끔 구현

- 웹 소켓은 전이중 통신이므로, 연속적인 데이터 전송의 신뢰성을 보장하기 위해 Handshake 과정을 진행
- 기존의 다른 TCP 기반의 프로토콜은 TCP layer에서의 Handshake를 통해 연결을 수립하는 반면, 웹 소켓은 HTTP요청 기반으로 Handshake 과정을 거쳐서 연결을 수립

- 웹 소켓은 연결을 수립하기 위해 `Upgrade`, `Connection`헤더를 포함하여 HTTP 요청을 보냄
- `200`응답 대신 웹 소켓은 `101 Swithching Protocols`같은 형식으로 응답

- Handshake 과정을 통해 연결이 수립되면, 응용 프로그램 계층 프로토콜이 HTTP 에서 웹 소켓으로 업그레이드가 된다.
- 업그레이드가 되면, HTTP는 사용되지 않고, 웹 소켓 연결이 닫힐 때 까지 두 끝 점에서 웹 소켓 프로토콜을 사용하여 데이터를 주고 받게 된다.

- 웹 소켓 연결은 주로 새로고침이나 창 닫기 등의 이벤트 발생 시 닫힌다.

---

### 웹 소켓 vs HTTP

- 웹 소켓이 HTTP 요청으로 시작되며 HTTP에서 동작하지만, 두 프로토콜은 분명히 다르게 동작한다.

- 웹 소켓과 HTTP의 차이점
- HTTP는 클라이언트와 서버간 접속을 유지하지 않으며, 요청과 응답 형태로 단방향 통신만 가능하다. 따라서 서버에서 클라이언트로의 요청은 불가능하다. (응답만 할 수 있을 뿐) 또한 요청-응답이 완료되면 수립했던 연결이 닫힌다. 여기서 `웹소켓`은 클라이언트와 서버간의 접속이 유지되며, 요청과 응답개념이 아닌 서로 데이터를 주고 받는 형식이다.
- REST한 방식의 HTTP 통신에서의 많은 URI와 HTTP METHOD를 통해 웹 어플리케이션과 상호작용하지만, `웹 소켓`은 초기 연결 수립을 위한 오직 하나의 URL만 존하며, 모든 메시지는 초기에 연결된 TCP 연결로만 통신한다.

