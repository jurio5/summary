

## 개념 요약

| 구분       | 식별 관계 (Identifying)            | 비식별 관계 (Non-identifying) |
| -------- | ------------------------------ | ------------------------ |
| 정의       | 부모 PK가 자식 PK의 일부로 포함됨          | 부모 PK가 자식의 일반 FK로만 사용됨   |
| PK 구성    | 부모 PK + 자식 식별자 (복합키)           | 자식 고유 PK (대리키)           |
| 관계 강도    | 강한 결합 (Tight Coupling)         | 느슨한 결합 (Loosely Coupled) |
| 대표 예시    | 아파트(동)-호수                      | 회사-사원                    |
| ORM 매핑   | 복잡 (`@IdClass`, `@EmbeddedId`) | 단순 (`@Id`)               |
| 유연성      | 낮음 (PK 변경 어려움)                 | 높음 (FK만 수정)              |
| 현대 설계 추세 | 지양                             | 지향 (Best Practice)       |
### 식별 관계

- 부모의 존재가 자식의 ‘식별자’ 일부가 됨
예: `'101동 502호'` → 부모 정보가 없으면 자식 식별 불가
### 비식별 관계

- 부모의 존재는 단지 연결 정보일 뿐
예: `'사원번호 777번'` → 독립적인 식별 가능

### 약한/강한 엔티티

| 엔티티 유형 | 관계 유형  | 특징           |
| ------ | ------ | ------------ |
| 약한 엔티티 | 식별 관계  | 부모 없이는 존재 불가 |
| 강한 엔티티 | 비식별 관계 | 독립적 존재 가능    |
## 식별 관계의 문제점

1. 유연성 부족
- PK 자체에 부모 FK가 포함 → 이동/변경 불가

2. PK 전파 문제 (PK 오염)
- 손자/증손자 관계로 갈수록 PK 복잡도 폭발

3. ORM 매핑 복잡성 증가
- `@EmbeddedId`, `@IdClass` 필요

4. 변경 불가성 위반 위험
- PK 수정은 데이터 무결성 훼손 가능
## 비식별 관계의 장점

- 단일 PK(`id`) 사용으로 단순하고 직관적
- 관계 변경 시 FK만 수정하면 됨
- ORM, API, URL, 서비스 계층 모두 단순화

## SQL 및 성능 비교

| 항목   | 식별 관계                                | 비식별 관계                 |
| ---- | ------------------------------------ | ---------------------- |
| 조회   | `WHERE board_id=10 AND comment_no=3` | `WHERE comment_id=500` |
| 인덱스  | 복합키 (기본 제공)                          | FK 별도 인덱스 필요           |
| 성능   | 특정 케이스에서 빠름                          | 인덱스 추가 시 동일            |
| 유지보수 | 복잡                                   | 단순                     |
- 인덱스 한 개 추가로 비식별 관계의 성능은 동일하게 확보 가능.
- 유연성과 확장성 면에서 비식별 관계가 압도적으로 유리하다.

## **현대적 설계의 3원칙**

| 구분     | 역할                   | 예시                         |
| ------ | -------------------- | -------------------------- |
| PK     | 대리 키 (Surrogate Key) | `id BIGINT AUTO_INCREMENT` |
| UNIQUE | 자연 키 (Natural Key)   | `email`, `ssn`             |
| FK     | 관계 표현 (비식별 관계)       | `member_id`, `board_id`    |
- 관계는 비식별, 키는 대리키
- 비식별 관계는 구조를 단순화하고, 변경에 유연하며, ORM 친화적이다.