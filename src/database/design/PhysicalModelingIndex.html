### `LIKE '%검색어%'` 인덱스 비활성화

- 일반적인 **B-Tree 인덱스**는 **왼쪽부터 정렬된 구조**를 기반으로 탐색한다.

- `LIKE '%검색어%'`는 문자열의 **앞부분이 불명확**하기 때문에, 인덱스가 어느 지점부터 탐색해야 할지를 판단할 수 없다.

- 그 결과 **Full Table Scan(전체 테이블 스캔)** 이 발생하며, 데이터가 많을수록 성능이 급격히 저하된다.

> “`LIKE '%검색어%'`처럼 검색어 앞에 `%`가 붙는 경우에는 일반적인 B-Tree 인덱스가 제대로 동작하지 않아 성능 향상에 한계가 있다.”

---

### 인덱스가 작동하는 경우

- `LIKE '검색어%'`처럼 **왼쪽이 고정된 경우**에는 B-Tree 인덱스 사용 가능하다.

- 실행 계획(`EXPLAIN`)에서 `type: range`, `Using index condition` 등이 표시된다.

예시:

`EXPLAIN SELECT product_name FROM product WHERE product_name LIKE '노트북%';`

- `idx_product_name` 인덱스가 사용됨
- `type: range`, `key: idx_product_name`, `Extra: Using index condition`

---

## 해결 방법

|방법|설명|
|---|---|
|**1. Full-Text Index 사용 (MySQL)**|`LIKE '%검색어%'` 대신 `MATCH() AGAINST()` 구문 사용. 단어 단위 전문 검색에 최적화되어 있음.|
|**2. Elasticsearch 사용**|별도의 검색 엔진을 붙여서 형태소 분석, 중간 단어 검색 등 복잡한 검색 처리에 활용.|
|**3. n-gram 인덱스 기법**|문자열을 일정 단위(예: 2~3자)로 분리하여 별도의 테이블에 인덱스를 생성. 중간 단어 검색을 빠르게 수행 가능.|
|**4. 접두어 검색으로 UX 개선**|프론트엔드/백엔드에서 `LIKE '검색어%'` 형태로만 검색하도록 제한(자동완성 방식 등).|

> “이런 전문적인 텍스트 검색 기능을 위해서는 MySQL의 `Full-Text Index`나 `Elasticsearch` 같은 별도의 검색 엔진을 사용하는 것이 실무적인 해결책이다.”

## 인덱스 설계 시 참고할 원칙

1. **인덱스는 순서대로 사용하라 (왼쪽 접두어 규칙)**
→ 인덱스는 왼쪽 컬럼부터 순차적으로 일치해야만 활용 가능하다.

2. **등호(=) 조건은 앞으로, 범위 조건(<, >)은 뒤로!**
→ 복합 인덱스 설계 시 컬럼 순서가 중요하다.

3. **정렬(ORDER BY)도 인덱스 순서를 따르라**
→ 인덱스 순서와 정렬 방향이 일치해야 정렬 시에도 인덱스를 사용할 수 있다.

---

## 정리 표

|검색 패턴|인덱스 사용 여부|설명|
|---|---|---|
|`'검색어%'`|사용됨|접두어 검색 (range scan)|
|`'%검색어'`|사용 안 됨|Full Table Scan|
|`'%검색어%'`|사용 안 됨|Full Table Scan|
|`MATCH() AGAINST()`|사용됨|Full-Text Index 필요|
|`LIKE '검색어%' + B-Tree`|사용됨|일반 인덱스 최적 활용|