
## 뷰(View) 소개

- **정의**: 뷰(View)는 실제 데이터를 가지지 않는 **가상의 테이블**이며, 데이터베이스에 저장된 `SELECT` 쿼리문이다.

- **특징**
- 바로가기(Shortcut)처럼 동작 → 데이터는 없고, 쿼리만 저장됨
- 조회 시 항상 최신 원본 데이터를 기준으로 실행됨

- **사용 이유**
1. **편리성**: 복잡한 쿼리를 단순화, 재사용 가능
2. **보안성**: 원본 테이블 접근 없이 제한된 데이터만 노출

## 뷰 생성, 조회, 수정, 삭제

### 1. 뷰 생성: `CREATE VIEW`

```sql
CREATE VIEW 뷰이름 AS
SELECT ...
```

```sql
-- 예시
DROP VIEW IF EXISTS v_category_order_status;

CREATE VIEW v_category_order_status AS
SELECT
p.category,
COUNT(*) AS total_orders,
SUM(CASE WHEN o.status = 'COMPLETED' THEN 1 ELSE 0 END) AS completed_count,
SUM(CASE WHEN o.status = 'SHIPPED' THEN 1 ELSE 0 END) AS shipped_count,
SUM(CASE WHEN o.status = 'PENDING' THEN 1 ELSE 0 END) AS pending_count
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY p.category;
```

### 2. 뷰 조회: `SELECT`
```sql
SELECT * FROM v_category_order_status;
```

### **3. 뷰 수정: `ALTER VIEW`**

```sql
ALTER VIEW v_category_order_status AS
SELECT
p.category,
SUM(p.price * o.quantity) AS total_sales, -- 매출액 컬럼 추가
COUNT(*) AS total_orders,
...
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY p.category;
```

### 4. 뷰 삭제: `DROP VIEW`

```sql
DROP VIEW v_category_order_status;
```

## 뷰의 장점과 단점

###  장점

1. **편리성과 재사용성**
- 복잡한 쿼리를 단순화 → `SELECT * FROM v_my_report;`
- 로직 수정 시 뷰만 변경하면 전체에 반영

2. **보안성**
- 특정 컬럼/행만 노출 가능 → 민감 정보 보호

3. **논리적 데이터 독립성**
- 테이블 구조 변경 시에도 응용 프로그램 수정 최소화
### 단점 및 주의사항

1. **성능 문제**
- 겉으로는 단순해도 내부 쿼리가 무거울 수 있음
- 중첩 뷰(Nested View) 사용 시 성능 저하

2. **업데이트 제약**
- `JOIN`, 집계 함수 등을 포함한 복잡한 뷰는 `INSERT/UPDATE/DELETE` 불가
- 기본적으로 **뷰는 조회용**으로 사용

## 최종 정리

- **뷰(View)** = 데이터 없는 가상의 테이블, 저장된 `SELECT` 쿼리
- **사용 목적**: 복잡한 쿼리 단순화, 보안 강화, 논리적 독립성 제공
- **핵심 명령어**
- `CREATE VIEW`: 생성
- `SELECT`: 조회
- `ALTER VIEW`: 수정
- `DROP VIEW`: 삭제
- **주의점**: 성능 문제, 업데이트 제약 → 조회용으로 활용