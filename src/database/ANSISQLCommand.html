
### MySQL

데이터베이스 생성 / 선택

```sql
CREATE DATABASE my_shop; -- 데이터베이스 생성
USE my_shop;             -- 사용할 데이터베이스 선택
```

테이블 생성

```sql
CREATE TABLE sample (
product_id INT PRIMARY KEY,
name VARCHAR(100),
price INT,
stock_quantity INT,
release_date DATE
);
```

구조 확인

```sql
DESC sample;      -- 테이블 구조 확인
SHOW DATABASES;   -- 모든 데이터베이스 목록 보기
SHOW TABLES;      -- 현재 데이터베이스의 테이블 목록 보기
```

삭제

```sql
DROP TABLE sample;       -- 테이블 삭제
DROP DATABASE my_shop;   -- 데이터베이스 삭제
```

데이터 추가 (Create)

```sql
INSERT INTO sample (product_id, name, price, stock_quantity, release_date)
VALUES (1, '프리미엄 청바지', 59900, 100, '2025-06-11');
```

데이터 조회 (Read)

```sql
SELECT * FROM sample;              -- 모든 컬럼 조회
SELECT name, price FROM sample;    -- 특정 컬럼만 조회
```

데이터 수정 (Update)

```sql
UPDATE sample
SET price = 40000
WHERE product_id = 1;
```

데이터 삭제 (Delete)

```sql
DELETE FROM sample
WHERE product_id = 1;
```

SQL 명령어 분류

```text
DDL (Data Definition Language) : 데이터 구조를 정의하는 명령어
CREATE, ALTER, DROP

DML (Data Manipulation Language) : 데이터를 조작하는 명령어
INSERT, SELECT, UPDATE, DELETE

DCL (Data Control Language) : 권한을 제어하는 명령어
GRANT, REVOKE

TCL (Transaction Control Language) : 트랜잭션을 제어하는 명령어
COMMIT, ROLLBACK
```

숫자 타입
정수나 소수 등 숫자 데이터를 저장한다.

```text
INT / INTEGER : 일반적인 정수 (4바이트)
TINYINT       : 매우 작은 정수 (1바이트)
SMALLINT      : 작은 정수 (2바이트)
MEDIUMINT     : 중간 크기 정수 (3바이트)
BIGINT        : 매우 큰 정수 (8바이트)
DECIMAL(M,D)  : 고정 소수점, 정확한 계산 필요 시 (금융 데이터 등)
FLOAT         : 단정밀도 부동소수점 (약간의 오차 허용)
DOUBLE        : 배정밀도 부동소수점
```

문자열 타입
문자나 텍스트 데이터를 저장한다.

```text
VARCHAR(n) : 가변 길이 문자열 (길이 다양할 때 사용)
CHAR(n)    : 고정 길이 문자열 (길이 항상 동일할 때 사용)
TEXT       : 긴 문자열 저장 (게시글 본문 등)
```

날짜와 시간 타입
날짜, 시간 또는 둘 다 저장한다.

```text
DATE       : 날짜 (YYYY-MM-DD)
TIME       : 시간 (HH:MM:SS)
DATETIME   : 날짜 + 시간 (타임존 영향 없음, 보통 실무에서 사용)
TIMESTAMP  : 날짜 + 시간 (타임존 자동 변환, 1970~2038년 범위)
YEAR       : 연도 (YYYY)
```

기타 타입
특수 데이터 저장 시 사용한다.

```text
BLOB  : 이미지, 오디오, 비디오 같은 이진 데이터
ENUM  : 미리 정의한 값 중 하나 선택 (DB 에서는 잘 사용하지 않고 애플리케이션에서 사용)
SET   : 미리 정의한 값 중 여러 개 선택 (DB 에서는 잘 사용하지 않고 애플리케이션에서 사용)
```

# 제약 조건(Constraints)

## 주요 제약 조건

### NOT NULL

**null 값을 허용하지 않음**

- 해당 컬럼에 반드시 값이 있어야 함
- INSERT 시 값을 입력하지 않으면 오류 발생
- 필수 데이터 필드에 사용

### UNIQUE

**중복된 값을 허용하지 않음**

- 테이블 내에서 해당 컬럼의 값은 유일해야 함
- 사용자 아이디(ID), 이메일 주소 등에 주로 사용
- PRIMARY KEY도 UNIQUE 속성을 포함함

### PRIMARY KEY (PK)

**기본 키 - 테이블의 각 행을 고유하게 식별**

- NOT NULL과 UNIQUE 제약 조건을 모두 가짐
- 테이블당 하나의 PRIMARY KEY만 지정 가능
- 데이터베이스에서 가장 중요한 제약 조건

### AUTO_INCREMENT

**자동 증가 값 생성**

- MySQL에서 PRIMARY KEY와 함께 사용
- PRIMARY KEY가 자동으로 1씩 증가
- 주로 ID 컬럼에 사용 (예: 1, 2, 3, 4...)

### FOREIGN KEY (FK)

**외래 키 - 다른 테이블의 PRIMARY KEY를 참조**

- 다른 테이블과의 관계를 설정
- 예: customer_id(FK)가 99라면, customers 테이블에 99번 고객이 실제로 존재해야 함
- 데이터 일관성을 보장

### DEFAULT

**기본값 설정**

- INSERT 시 값을 지정하지 않으면 기본값이 자동 입력
- 숫자는 0, 문자열은 빈 문자열(''), 날짜는 현재 날짜 등으로 설정 가능

### CHECK

**값의 범위나 조건을 검사**

- 특정 조건을 만족하는 값만 입력 허용
- 예시:
- 나이는 10세 이상이어야 함
- 성인 연령은 18세 이상이어야 함

## 제약 조건 사용 예시

문서에서 사용한 기본 테이블 구조:

```sql
CREATE TABLE sample (
product_id INT PRIMARY KEY,      -- PRIMARY KEY 제약
name VARCHAR(100),               -- 가변 길이 문자열
price INT,                       -- 정수형
stock_quantity INT,              -- 정수형
release_date DATE                -- 날짜형
);
```

## 제약 조건의 특징

- 제약 조건은 '올바른 데이터만 테이블에 저장되도록' 보장
- 잘못된 데이터가 들어가는 것을 미리 방지
- 데이터의 품질과 일관성을 유지하는 중요한 역할
- PRIMARY KEY는 각 행을 구별하는 핵심 역할
- FOREIGN KEY는 테이블 간의 관계를 명확히 정의

```java
CONSTRAINT fk_orders_customers FOREIGN KEY (customer_id) REFERENCES customers(customer_id),
CONSTRAINT fk_orders_products foreign KEY (product_id) REFERENCES products(product_id)

CONSTRAINT [제약조건_이름]
FOREIGN KEY ([자식_테이블의_컬렴명])
REFERENCES [부모_테이블명]([부모_테이블의_컬럼명])
```

### 전체적인 명령어 정리

```sql
-- ========================================
-- 데이터베이스 생성 / 선택
-- ========================================
CREATE DATABASE my_shop;      -- 데이터베이스 생성
USE my_shop;                   -- 사용할 데이터베이스 선택

-- ========================================
-- 테이블 생성 (DDL - CREATE)
-- ========================================
CREATE TABLE customers (
customer_id INT AUTO_INCREMENT PRIMARY KEY, -- 고객 ID (기본 키 + 자동 증가)
name VARCHAR(50) NOT NULL,                  -- 고객명 (필수)
email VARCHAR(100) NOT NULL UNIQUE,          -- 이메일 (고유값)
password VARCHAR(255) NOT NULL,              -- 비밀번호
address VARCHAR(255) NOT NULL,               -- 주소
join_date DATETIME DEFAULT CURRENT_TIMESTAMP -- 가입 시각 (기본값 현재 시각)
);

CREATE TABLE products (
product_id INT AUTO_INCREMENT PRIMARY KEY,  -- 상품 ID (기본 키 + 자동 증가)
name VARCHAR(100) NOT NULL,                  -- 상품명 (필수)
description TEXT,                             -- 상품 설명 (선택)
price INT NOT NULL,                           -- 가격 (필수)
stock_quantity INT NOT NULL DEFAULT 0         -- 재고 수량 (기본 0)
);

CREATE TABLE orders (
order_id INT AUTO_INCREMENT PRIMARY KEY,     -- 주문 ID (기본 키 + 자동 증가)
customer_id INT NOT NULL,                     -- 주문 고객 ID
product_id INT NOT NULL,                      -- 주문 상품 ID
quantity INT NOT NULL,                        -- 주문 수량
order_date DATETIME DEFAULT CURRENT_TIMESTAMP,-- 주문 시각
status VARCHAR(20) NOT NULL DEFAULT '주문접수',-- 주문 상태
CONSTRAINT fk_orders_customers FOREIGN KEY (customer_id)
REFERENCES customers(customer_id),
CONSTRAINT fk_orders_products FOREIGN KEY (product_id)
REFERENCES products(product_id)
);

-- ========================================
-- 테이블 구조 변경 (DDL - ALTER TABLE)
-- ========================================
ALTER TABLE customers
ADD COLUMN point INT NOT NULL DEFAULT 0;          -- 컬럼 추가

ALTER TABLE customers
MODIFY COLUMN address VARCHAR(500) NOT NULL;      -- 컬럼 타입 변경

ALTER TABLE customers
DROP COLUMN point;                                -- 컬럼 삭제

-- ========================================
-- 테이블/데이터 삭제 (DDL - DROP / TRUNCATE)
-- ========================================
DROP TABLE products;                              -- 테이블 삭제
TRUNCATE TABLE products;                          -- 데이터만 삭제 (AUTO_INCREMENT 초기화)
DROP DATABASE my_shop;                            -- 데이터베이스 삭제

-- 외래 키 체크 비활성화 후 삭제
SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE products;
SET FOREIGN_KEY_CHECKS = 1;

-- ========================================
-- 데이터 추가 (DML - INSERT)
-- ========================================
-- 전체 컬럼에 값 입력
INSERT INTO customers VALUES (NULL, '강감찬', 'kang@example.com', 'pw123', '서울시 관악구', NOW());

-- 특정 컬럼만 입력
INSERT INTO products (name, price, stock_quantity)
VALUES ('반팔 티셔츠', 15000, 100);

-- 여러 행 한 번에 입력
INSERT INTO products (name, price, stock_quantity) VALUES
('검정 양말', 5000, 50),
('흰색 양말', 5000, 100);

-- ========================================
-- 데이터 조회 (DML - SELECT)
-- ========================================
SELECT * FROM customers;                          -- 모든 컬럼 조회
SELECT name, email FROM customers;                -- 특정 컬럼 조회
SELECT * FROM products WHERE price > 10000;       -- 조건 조회

-- ========================================
-- 데이터 수정 (DML - UPDATE)
-- ========================================
UPDATE products
SET price = 9800, stock_quantity = 500
WHERE product_id = 1;

-- 안전 업데이트 모드 해제/활성화
SET SQL_SAFE_UPDATES = 0;
SET SQL_SAFE_UPDATES = 1;

-- ========================================
-- 데이터 삭제 (DML - DELETE)
-- ========================================
DELETE FROM products
WHERE product_id = 1;

-- ========================================
-- 권한 제어 (DCL - GRANT / REVOKE)
-- ========================================
GRANT SELECT, INSERT ON my_shop.* TO 'user1'@'localhost';
REVOKE INSERT ON my_shop.* FROM 'user1'@'localhost';

-- ========================================
-- 트랜잭션 제어 (DCL - COMMIT / ROLLBACK)
-- ========================================
START TRANSACTION;
UPDATE products SET price = 10000 WHERE product_id = 1;
COMMIT;
-- 또는
ROLLBACK;

```