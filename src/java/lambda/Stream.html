### 스트림의 특징

1. 데이터 소스를 변경하지 않음 (불변성, Immutable)
- 스트림에서 제공하는 연산들은 원본 컬렉션(예: `List`, `Set`)을 변경하지 않고 결과만 새로 생성한다.
2. 일회성 (1회 소비)
- 한 번 사용(소비)된 스트림은 다시 사용할 수 없으며, 필요하다면 새로 스트림을 생성해야 한다.
3. 파이프라인(Pipeline) 구성
- 중간 연산(map, filter 등)들이 이어지다가, 최종 연산(forEach, collect, reduce 등)을 만나면 연산이 수행되고 종료된다.
- 스트림은 파이프라인 방식으로 처리를 한다.
4. 지연 연산 (Lazy Operation)
- 중간 연산은 필요할 때까지 실제로 동작하지 않고, 최종 연산이 실행될 때 한 번에 처리된다.
5. 병렬 처리(Parallel) 용이
- 스트림으로부터 병렬 스트림(Parallel Stream) 을 쉽게 만들 수 있어서, 멀티코어 환경에서 병렬 연산을 비교적 단순한 코드로 작성할 수 있다.

### 지연 연산 (Lazy Operator)

- 쉽게 이야기하면 스트림 API는 매우 게으르다(Lazy). 정말 꼭! 필요할 때만 연산을 수행하도록 최대한 미루고 미룬다.
- 그래서 연산을 반드시 수행해야 하는 최종 연산을 만나야 본인이 가지고 있던 중간 연산들을 수행한다.
- 이렇게 꼭 필요할 때 까지 연산을 최대한 미루는 것을 지연(Lazy) 연산 이라 한다.
- 파이프라인 방식으로 처리를 하기에 최종 연산 때 한 번에 처리가 되는 것이며, 처리되기 전 까진 임의의 내부 저장소에 담아뒀다가 최종 연산 시 처리가되고, 최종 연산이 없다면 객체가 생성되지 않는다.

### 스트림의 장점

- 기본적으로 일괄 처리 같은 경우는 반복문을 돌렸을 때 `filter` , `map`과 같은 연산들을 이용해서 필터에 대한 첫 번째 값만 출력해라. 라는 조건이 있을 때 전부 다 수행 후 최종 연산이 처리가 되는데 파이프라인 방식으로 처리하는 스트림의 경우는 하나의 연산이 끝나면 바로 스트림이라는 뜻 그대로 시냇물 흐르듯이 한 번의 연산이 끝나고 다음 연산을 하는 방식으로 처리를 하기 때문에 `FindFirst()`메서드의 경우 중간 연산 2번(`filter`,`mapping`) 최종 연산 1번 으로 끝난다.
- 이 부분이 얼마나 큰 차이냐면 수 백만 건의 데이터를 훑어봐야할 때 일괄 처리의 경우 수 백만의 데이터를 전 부 다 뒤져서 하나의 수를 뽑아내지만, 스트림은 단 3번의 연산으로 처리를 한다.
- 이 모든게 스트림의 `지연 연산` 과 `파이프라인` 방식의 처리 덕분에 가능한 것이다.
- 이를 `단축 평가`(short-circuit) 라고 하며, 조건을 만족하는 결과를 찾으면 더 이상 연산을 진행하지 않는 방식이다.

### 스트림 API

- 스트림 API는 간단히 말하면, 스트림 이라는 강물에 중간 연산과 최종 연산을 통하여 만들어지는 연산에 필요한 메서드들의 모음을 말함 (FindFirst, ForEach, Reduce 등)
- 스트림 API의 핵심은 `어떤 연산을 할지` 파이프라인으로 정의해놓고, 최종 연산이 실행될 때 한 번에 처리한다는 점이다.
- 이를  통해서 필요한 시점에만 데이터를 처리하고, 필요 이상으로 처리하지 않는다는 효율성을 얻을 수 있다.

### 기본형 특화 스트림

- 스트림 API 에는 기본형(primitive) 특화 스트림이 존재함
- 자바에서는 `IntStream`, `LongStream`, `DoubleStream` 세 가지 형태를 제공하여 기본 자료형(int, long, double)에 특화된 기능을 사용할 수 있게 함
- 예를들어, `IntStream`은 **합계 계산, 평균, 최솟값, 최댓값** 등 정수와 관련된 연산을 좀 더 편리하게 제공하고, **오토박싱/언박싱** 비용을 줄여 성능도 향상시킬 수 있음
- 기본형 특화 스트림의 숫자 범위 생성 가능
- `range(int startInclusive, int endExclusive)` : **시작 값 이상, 끝 값 `미만`**
- `IntStream.range(1, 5) -> [1, 2, 3, 4]`
- `rangeClosed(int startInclusive, int endInclusive)` : **시작 값 이상, 끝 값 `포함`**
- `IntStream.rangeClosed(1,  5) -> [1, 2, 3, 4, 5]`

## 기본형 특화 스트림 주요 기능 및 메서드

| 스트림 타입       | 메서드 또는 기능                    | 설명                                                  |
| ------------ | ---------------------------- | --------------------------------------------------- |
| IntStream    | `range(start, end)`          | 시작값(포함)부터 끝값(미포함)까지의 int 스트림 생성                     |
| IntStream    | `rangeClosed(start, end)`    | 시작값과 끝값을 모두 포함하는 int 스트림 생성                         |
| IntStream    | `of(values...)`              | 주어진 값들로 int 스트림 생성                                  |
| IntStream    | `iterate(seed, f)`           | 시드값에서 시작해 함수 f를 적용한 무한 스트림 생성                       |
| IntStream    | `generate(Supplier)`         | Supplier로부터 무한 스트림 생성                               |
| IntStream    | `sum()`                      | 스트림의 합                                              |
| IntStream    | `average()`                  | 스트림의 평균 (OptionalDouble 반환)                         |
| IntStream    | `min()` / `max()`            | 최소값 / 최대값 반환 (OptionalInt 반환)                       |
| IntStream    | `boxed()`                    | int → Integer로 박싱하여 Stream<Integer>로 변환             |
    | LongStream   | `range`, `rangeClosed` 등     | IntStream과 동일한 방식으로 사용 가능                           |
    | DoubleStream | `of`, `generate`, `iterate`  | IntStream과 동일한 방식으로 사용 가능                           |
    | DoubleStream | `average()`                  | 평균 계산 (OptionalDouble 반환)                           |
    | DoubleStream | `mapToInt()` / `mapToLong()` | double 값을 int 또는 long으로 변환한 스트림 생성                  |
    | 공통           | `distinct()`                 | 중복 제거                                               |
    | 공통           | `sorted()`                   | 오름차순 정렬                                             |
    | 공통           | `summaryStatistics()`        | 합계, 평균, 최댓값, 최솟값, 개수 등을 요약 (IntSummaryStatistics 등) |

    ### 컬렉터
    - 스트림이 중간 연산을 거쳐 최종 연산으로써 데이털르 처리할 때, 그 결과물이 필요한 경우가 많다. 대표적으로 `리스트나 맵 같은 자료구조에 담고 싶다`거나 `통계 데이터를 내고 싶다`는 식의 요구가 있을 때, 이 최종 연산에 `Collectors`를 활용한다.

    | 기능     | 메서드                                                                | 설명                     | 반환 타입                                      |
    | ------ | ------------------------------------------------------------------ | ---------------------- | ------------------------------------------ |
    | 리스트 수집 | `toList()`, `toUnmodifiableList()`                                 | 수정 가능/불변 리스트 수집        | `List<T>`                                  |
        | 집합 수집  | `toSet()`, `toCollection(...)`                                     | 중복 제거, Set 구현체 지정 가능   | `Set<T>`                                   |
            | 맵 수집   | `toMap(k, v)`, `toMap(k, v, merge, mapType)`                       | 키 중복 처리 및 타입 지정 가능     | `Map<K, V>`                                |
            | 그룹화    | `groupingBy(classifier, downstream)`                               | 기준별 그룹, 다운스트림으로 후처리 가능 | `Map<K, R>`                                |
            | 분할     | `partitioningBy(predicate, downstream)`                            | true/false 기준 2분할      | `Map<Boolean, R>`                          |
            | 통계     | `counting()`, `summingInt()`, `averagingInt()`, `summarizingInt()` | 수량, 합계, 평균, 요약 통계 등    | `Long`, `Double`, `IntSummaryStatistics` 등 |
            | 리듀싱    | `reducing(...)`                                                    | 요소를 누적/축소하여 하나로        | `Optional<T>`, 지정 타입                       |
                | 문자열 연결 | `joining(", ", "[", "]")`                                          | 요소를 문자열로 합침            | `String`                                   |
                | 매핑     | `mapping(mapper, downstream)`                                      | 요소 변환 후 수집             | 다운스트림 반환 타입                                |

                ### 다운 스트림 컬렉터
                - `groupingBy(...)`를 사용하면 일단 요소가 그룹별로 묶이지만, 그룹 내 요소를 구체적으로 어떻게 처리할지는 기본적으로 `toList`만 적용된다.
                - 그런데 실무에서는 "그룹별 총합, 평균, 최대/최소값" 등을 바로 얻고 싶을 때가 많다.
                - 에를 들어, "학년별로 학생들을 그룹화한 뒤, 각 학년 그룹에서 평균 점수를 구하고 싶다"는 상황에서는 단순히 `List<Student>`로 끝나는 것이 아니라, 그룹 내 학생들의 점수를 합산하고 평균을 내는 동작이 더 필요하다. 이처럼 그룹화된 이후 각 그룹 내부에서 추가적인 연산 또는 결과물(예: 평균, 합계, 최댓값, 최솟값,통계, 다른 타입으로 변환 등)을 정의하는 역할을 하는 것이 바로 다운 스트림 컬렉터(Dowstream Collector)이다.
                    - 이때 다운 스트림 컬렉터를 활용하면 "그룹 내부"를 다시 한 번 모으거나 집계하여 원하는 결과를 얻을 수 있다.
                    - 예 :`groupingBy(분류함수, counting()) -> 그룹별 개수`
                    - 예 : `groupingBy(분류함수, summingInt(Student::getScore)) -> 그룹별 점수 합계`
                    - 예 : `groupingBy(분류함수, mapping(Student::getName, toList())) -> 그룹별 학생 이름 리스트`

                    #### 다운 스트림 컬렉터 정의
                    - `Collectors.groupingBy(...)` 또는 `Collectors.partitioningBy(...)`에서 두 번째 인자로 전달되는 `Collector`를 가리켜 `다운 스트림 컬렉터` 라고 한다.
