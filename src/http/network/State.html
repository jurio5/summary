### **Stateful (상태유지)**

**상태 유지**라 함은 클라이언트와 서버 관계에서 **서버가 클라이언트의 상태를 보존**함을 의미한다.

클라이언트와 서버 간에 송수신을 하며 단계별 과정을 진행하는데 있어, 서버에서 클라이언트가 이전 단계에서 제공한 값을 저장하고 다음 단계에서도 저장한 상태이다.

대표적으로 홈페이지에서 한번 로그인을 하면 페이지를 이동해도 로그인이 풀리지않고 계속 유지되는 것이 바로 서버가 클라이언트의 상태를 유지(기억)하고 있으니까 가능한 것이다.

클라이언트의 정보를 기억한다라는 말은 어딘가에 정보를 저장하고 통신할때마다 읽는다는 뜻이다.

이러한 정보들은 일반적으로 브라우저의 쿠키(Cookie)에 저장되거나, 서버의 세션(Session) 메모리에 저장되어 상태를 유지하게 된다.

- Stateful을 간단한 예시로 비유를 하자면 아래와 같다.

**상황:**
고객이 자주 방문하는 레스토랑에서는 점원이 고객을 기억하고, 이전 주문 기록을 바탕으로 맞춤형 서비스를 제공한다.

## Stateful (상태 유지) - 단골이 있는 레스토랑
### **첫 번째 방문**

👤 고객: "안녕하세요! 메뉴 추천해 주실 수 있나요?"
👨‍🍳 점원: "네! 한우 등심 스테이크가 인기 많아요. 어떻게 요리해 드릴까요?"
👤 고객: "미디엄 레어로 주세요."
👨‍🍳 점원: "네, 준비해 드리겠습니다!"
👤 고객: (식사 후 결제) "맛있었어요, 감사합니다!"
👨‍🍳 점원: "감사합니다! 다음에 또 오세요~"

### **두 번째 방문 (점원이 고객을 기억함)**

👤 고객: "안녕하세요!"
👨‍🍳 점원: "안녕하세요, 고객님! 지난번에 미디엄 레어 스테이크 드셨죠? 오늘도 같은 걸로 준비해 드릴까요?"
👤 고객: "네! 사이드로 감자튀김도 추가해주세요."
👨‍🍳 점원: "알겠습니다. 바로 준비해 드릴게요!"

** Stateful의 특징:**

- 고객이 재방문하면 점원이 이전 방문 기록을 기억하고 있다.
- 고객이 상세한 주문을 반복할 필요 없이, 더 빠르고 편리하게 서비스를 받을 수 있다.
- 서버(점원)는 고객의 상태(이전 주문 기록)를 유지하고 있다.
- 세션 기반 인증처럼 서버가 상태를 저장하며, 지속적인 연결이 필요한 서비스에 적합하다.

---

### **Stateless (무상태)**

- Stateless를 간단한 예시로 비유를 하자면 아래와 같다.

**상황:**
햄버거 가게에서 주문할 때, 점원은 고객을 기억하지 않고 매번 새롭게 응대한다.
## **Stateless (무상태) - 패스트푸드점**

### **첫 번째 방문**

👤 고객: "안녕하세요, 햄버거 세트 하나 주세요."
👨‍🍳 점원: "어떤 세트로 드릴까요?"
👤 고객: "불고기 버거 세트 주세요."
👨‍🍳 점원: "네, 총 7,000원입니다."
👤 고객: (결제 후 햄버거를 받음)

### **두 번째 방문 (점원은 고객을 기억하지 못함)**

👤 고객: "안녕하세요, 저번에 먹었던 거랑 똑같이 주세요."
👨‍🍳 점원: "어떤 세트로 드릴까요?"
👤 고객: "불고기 버거 세트요."
👨‍🍳 점원: "네, 총 7,000원입니다."
👤 고객: (결제 후 햄버거를 받음)

** Stateless의 특징:**

- 고객이 다시 방문해도 점원은 이전 주문을 기억하지 못한다.
- 고객은 매번 원하는 메뉴를 처음부터 다시 말해야 한다.
- 서버(점원)는 이전 상태를 유지하지 않고, 요청이 들어올 때마다 독립적으로 처리한다.
- REST API처럼 매 요청이 독립적으로 수행되며, 상태를 저장하지 않는 방식에 적합하다.

## **정리: Stateless vs Stateful**

| 개념        | Stateless (무상태)          | Stateful (상태 유지)            |
| --------- | ------------------------ | --------------------------- |
| **상태 유지** |  이전 요청을 기억하지 않음         |  이전 요청을 기억함                |
| **예시**    | 패스트푸드점 (매번 새롭게 주문)       | 단골 레스토랑 (고객 정보 기억)          |
| **서버 역할** | 매 요청을 독립적으로 처리           | 클라이언트 상태를 저장하고 관리           |
| **장점**    | 확장성이 뛰어나고, 서버 부하가 적음     | 사용자의 편의성이 높고, 맞춤형 서비스 제공 가능 |
| **단점**    | 사용자가 매번 같은 정보를 다시 입력해야 함 | 서버에 부하가 걸릴 수 있음             |
| **사용 사례** | REST API, JWT 인증         | 세션 기반 인증, 채팅 서비스            |

### **추가 보완**

- **Stateless 예시: JWT 인증**
→ 로그인할 때 토큰을 발급받고, 이후 요청할 때마다 토큰을 전달해 인증한다.
→ 서버는 사용자의 로그인 상태를 유지하지 않고, 토큰만 검증하여 인증을 수행한다.
→ 따라서 확장성이 뛰어나며, 여러 서버에서 동일한 방식으로 인증할 수 있다.

- **Stateful 예시: 세션 기반 인증**
→ 로그인하면 서버에 세션을 저장하고, 이후 요청 시 세션 ID를 기반으로 사용자를 식별한다.
→ 서버가 클라이언트의 상태를 저장하고 있으므로, 여러 요청 간 상태를 유지할 수 있다.
→ 그러나 서버에 부하가 증가할 수 있으며, 확장성이 제한될 수 있다.