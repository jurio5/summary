
- URI(Uniform Resource Identifier)로 HTTP 메서드를 나눌 때 어떤 방식으로 만드는게 좋을까?
- 최근 HTTP 스펙에선 `Resource`가 `Representation`으로 바뀜.

- HTTP 메서드는 `자원`에 집중을 해야한다. 예로 멤버를 들어보자면 여기서 `자원`이라고 하는 것은 `회원`이라는 것을 두고 하는 말인데 기본적으로 이런 URI를 `자원`에 집중하라 라는 것은 아래와 같다.
- 전체 회원 조회 : `/members`
- 특정 회원 조회 : `/members/{id}`
- 회원 생성 : `/members/{id}`
- 회원 수정 : `/members/{id}`
- 회원 삭제 : `/members/{id}`

- 그렇다면 어떻게 저 URI를 식별할 수 있을까? 한다면 답은 HTTP 메서드에 있다.
- 특정 회원 조회 : `GET`
- 회원 생성 : `POST`
- 회원 수정 : `PUT & PATCH & POST`
- `PUT` : 전체 리소스 업데이트 및 없으면 생성
- 클라이언트가 리소스를 지정해서 업데이트 할 때
- 예로 /members/*`100`* URI의 정보를 수정
- `PATCH` : 일부 필드만 업데이트 (사용자 닉네임 변경 등)
- 회원 삭제 : `DELETE`

- 이와 같이 엔드포인트의 설계는 간략하게 하되 HTTP 메서드를 기준으로 `자원`을 나누는 것이 중요하다.

- 그러나 항상 이상적인 상황만 있는 것이 아니다. POST의 결과로 새로운 리소스가 생성되지 않을 수도 있다. 이런 경우는 아래와 같이 `컨트롤URI` 방식을 통해 해결한다.
- POST /orders/{orderId}/start-delivery
- POST 를 사용 해야하는 경우는 새로운 리소스를 알 수 없을 때 사용을 하는데 예로들면 /members 로 회원을 등록 할 때 클라이언트 쪽에서 {id}를 알 수 없는 경우 서버에서 처리를 해야할 때 POST 를 사용한다.
- 이런 경우들은 보통 HTML FORM 방식 즉, 타임리프 같은 서버사이드렌더링 방식을 사용할 때 발생하는데, 이유는 SSR 방식에서는 `GET`, `POST` 방식만 지원하기 때문이다. 물론, 히든 메서드 라는 방식으로 우회해서 `DELETE`를 사용하는 방법도 있다.
- 또는 다른 메서드로 처리하기 애매한 경우가 있다.
- JSON으로 조회 데이터를 넘겨야 하는데, GET 메서드를 사용하기 어려운 경우 (보통 조회를 할 때 메시지 바디에 정보를 담아서 조회를 하는 경우)
- 일반적인 조회를 할 땐 메시지 GET 메서드를 사용해서 넘기면 쿼리 파라미터로 데이터가 넘어간다.
- 이럴 땐 POST를 사용한다. 사실 POST는 모든 정보를 다 담을 수 있지만 상황에 맞는 HTTP 메서드를 사용하는게 좋다. (캐싱 문제)
- 예외 상황으로 `PATCH`를 못 받아들이는 서버가 있는데 이럴 경우는 `POST`로 대체해서 사용할 수 있다.
- `PUT`을 사용할 때 좋은 방법은 파일 등록 같은 API를 사용할 때 유용하다.
- 클라이언트 쪽에서 /files/{filename} 즉, filename 이라는 리소스 자원을 알고 있는 상태에서 서버로 보내기 때문에 `POST`보다 더 알맞는 상황이고, 파일 등록의 특성 상 기존 파일이 있으면 덮어야하고, 없을 때 등록을 해야하는데 이 때 사용할 수 있는 알맞은 HTTP 메서드는 `PUT`이다.
#### 용어 정리
- 컬렉션(Collection) : 서버가 리소스의 URI를 생성하고 관리하는 부분
- ex) /members/{id} -> {id}는 클라이언트는 리소스 자원을 모르고 서버가 처리할 때
- 스토어(Stroe) : 클라이언트가 리소스 URI를 알고 관리할 때
- ex) /files/{filename} -> {filename}은 클라이언트가 직접 리소스의 자원을 지정할 때